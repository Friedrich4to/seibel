---
interface Props {
  darkMode?: boolean;
}

const { darkMode = false } = Astro.props;
---

<nav id="navbar-mobile" class:list={["block lg:hidden fixed w-full z-50", { "dark-mode": darkMode }]}>
    <div class="flex flex-col">
      <!-- Top Bar with Logo and Burger -->
      <div class="py-8 px-6 flex items-center justify-between transition-all duration-300" id="top-bar">
        <a href="/" class="flex items-center">
          <svg id="Capa_1" data-name="Capa 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1002.74 199.36" class="h-8 w-auto">
            <defs>
              <style>
                .cls-1 {
                  fill: #91642c;
                }

                .cls-2 {
                  fill: #f3f3f3;
                }
              </style>
            </defs>
            <g>
              <path class="cls-2" d="M6.96,52.83c4.93,5.25,12.64,9.86,22.61,9.86s14.36-5.04,14.36-9.75c0-6.43-7.61-8.36-16.29-10.61-11.68-2.89-25.4-6.32-25.4-21.43C2.25,9.11,12.64,0,28.29,0c11.15,0,20.15,3.54,26.79,9.97l-7.18,9.32c-5.57-5.57-13.18-8.14-20.68-8.14s-12.11,3.54-12.11,8.9,7.29,7.39,15.75,9.54c11.79,3,25.82,6.64,25.82,22.18,0,11.89-8.36,22.07-27.65,22.07-13.18,0-22.72-4.61-29.04-11.36l6.96-9.64Z"/>
              <path class="cls-2" d="M100.56,72.54V1.07h48.97v11.03h-36.43v18.54h35.68v11.04h-35.68v19.82h36.43v11.04h-48.97Z"/>
              <path class="cls-2" d="M197.6,72.54V1.07h12.54v71.47h-12.54Z"/>
              <path class="cls-2" d="M259.94,72.54V1.07h35.15c13.07,0,20.36,8.14,20.36,18.22,0,9-5.79,15-12.43,16.39,7.61,1.18,13.82,8.79,13.82,17.57,0,11.04-7.39,19.29-20.79,19.29h-36.11ZM272.48,30.65h20.04c6.43,0,10.07-3.86,10.07-9.22s-3.64-9.32-10.07-9.32h-20.04v18.54ZM272.48,61.51h20.57c6.86,0,10.93-3.75,10.93-9.97,0-5.36-3.75-9.86-10.93-9.86h-20.57v19.82Z"/>
              <path class="cls-2" d="M364.1,72.54V1.07h48.97v11.03h-36.43v18.54h35.68v11.04h-35.68v19.82h36.43v11.04h-48.97Z"/>
              <path class="cls-2" d="M465.63,72.54V1.07h12.54v60.43h31.5v11.04h-44.04Z"/>
              <path class="cls-2" d="M197.6,186.54v-31.18h-37.18v31.18h-12.54v-71.47h12.54v29.25h37.18v-29.25h12.54v71.47h-12.54Z"/>
              <path class="cls-2" d="M259.95,186.54v-71.47h48.97v11.03h-36.43v18.54h35.68v11.04h-35.68v19.82h36.43v11.04h-48.97Z"/>
              <path class="cls-2" d="M407.45,186.54l-37.29-52.08v52.08h-12.54v-71.47h12.86l36.54,50.68v-50.68h12.54v71.47h-12.11Z"/>
              <path class="cls-2" d="M506.45,186.54l-15.86-26.68h-12.43v26.68h-12.54v-71.47h31.4c14.14,0,23.36,9.21,23.36,22.39s-8.36,19.61-16.93,21l17.46,28.07h-14.47ZM495.31,126.11h-17.14v22.72h17.14c7.07,0,12.21-4.5,12.21-11.36s-5.14-11.36-12.21-11.36Z"/>
              <path class="cls-2" d="M567.05,186.54v-71.47h12.54v71.47h-12.54Z"/>
              <path class="cls-2" d="M744.69,115.07h12.64v42.86c0,11.36,6.32,18.75,18.32,18.75s18.22-7.39,18.22-18.75v-42.86h12.64v43.18c0,17.79-10.18,29.57-30.86,29.57s-30.97-11.89-30.97-29.47v-43.29Z"/>
              <path class="cls-2" d="M856.29,186.54v-71.47h48.97v11.03h-36.43v18.54h35.68v11.04h-35.68v19.82h36.43v11.04h-48.97Z"/>
              <path class="cls-2" d="M949.17,186.54v-10.18l36.54-50.26h-36.54v-11.03h52.83v10.18l-36.54,50.25h37.29v11.04h-53.58Z"/>
              <path class="cls-2" d="M698.84,150.87c0-21.34-15.09-36.98-36.53-36.98s-36.55,15.64-36.55,36.98c0,12.84,5.47,23.6,14.5,30.12,3.65,2.67,7.87,4.61,12.54,5.72,2.99.73,6.18,1.12,9.51,1.12,3.9,0,7.61-.52,11.03-1.5l7.75,13.04h14.46l-11.35-18.26c9.12-6.52,14.64-17.33,14.64-30.23ZM667.33,176.2c-1.6.32-3.26.48-5.02.48-3.49,0-6.68-.66-9.51-1.85-5.97-2.53-10.33-7.46-12.54-13.82-1.07-3.08-1.64-6.52-1.64-10.15s.57-7.11,1.64-10.21c1.94-5.59,5.52-10.03,10.4-12.74,3.33-1.85,7.25-2.87,11.65-2.87s8.44,1.07,11.79,2.99c7.46,4.22,11.88,12.63,11.88,22.85,0,12.88-7.18,23.05-18.65,25.33Z"/>
              <polygon class="cls-2" points="589.91 94.87 579.59 106.68 567.05 106.68 575.64 94.87 589.91 94.87"/>
            </g>
            <polygon class="cls-1" points="105.35 145.83 105.35 153.81 24.35 153.81 24.35 115.07 32.33 115.07 32.33 145.83 105.35 145.83"/>
            <polygon class="cls-1" points="979.95 32.03 979.95 72.55 971.97 72.55 971.97 40.01 531.54 40.01 531.54 32.03 979.95 32.03"/>
          </svg>
        </a>

        <!-- Burger Button -->
        <button id="burger-btn" class="flex flex-col justify-center items-center w-8 h-8 space-y-1.5" aria-label="Toggle menu">
          <span class="burger-line w-6 h-0.5 bg-white transition-all duration-300"></span>
          <span class="burger-line w-6 h-0.5 bg-white transition-all duration-300"></span>
          <span class="burger-line w-6 h-0.5 bg-white transition-all duration-300"></span>
        </button>
      </div>

      <!-- Mobile Menu -->
      <div class="flex flex-col px-6 pb-8 space-y-6 uppercase transition-all duration-300" id="menu">
        <a href="/la-firma" class="nav-link text-base font-light hover:text-bronze transition-colors">
          La Firma
        </a>
        <a href="/nuestro-equipo" class="nav-link text-base font-light hover:text-bronze transition-colors">
          Nuestro Equipo
        </a>
        <a href="/areas-de-practica" class="nav-link text-base font-light hover:text-bronze transition-colors">
          Áreas de Práctica
        </a>
        <a href="/recursos" class="nav-link text-base font-light hover:text-bronze transition-colors">
          Recursos
        </a>
        <a href="/carreras" class="nav-link text-base font-light hover:text-bronze transition-colors">
          Carreras
        </a>
        <a href="/compromiso-social" class="nav-link text-base font-light hover:text-bronze transition-colors">
          Compromiso Social
        </a>
      </div>
    </div>
</nav>

<style>
  /* Initial state - transparent background */
  #top-bar {
    background-color: transparent;
  }

  /* Menu is hidden by default */
  #menu {
    max-height: 0;
    overflow: hidden;
    opacity: 0;
  }

  /* Scrolled state */
  #navbar-mobile.scrolled #top-bar {
    background-color: var(--color-light-gray);
  }

  /* Menu open state */
  #navbar-mobile.menu-open #top-bar,
  #navbar-mobile.menu-open #menu {
    background-color: var(--color-light-gray);
  }

  #navbar-mobile.menu-open #menu {
    max-height: 100vh;
    opacity: 1;
  }

  /* Nav links color - white by default */
  .nav-link {
    color: white;
  }

  /* Nav links color when scrolled or menu open */
  #navbar-mobile.scrolled .nav-link,
  #navbar-mobile.menu-open .nav-link {
    color: var(--color-dark-slate);
  }

  /* SVG colors when scrolled or menu open */
  #navbar-mobile.scrolled svg .cls-2,
  #navbar-mobile.menu-open svg .cls-2 {
    fill: var(--color-dark-slate);
  }

  /* Burger lines color when scrolled or menu open */
  #navbar-mobile.scrolled .burger-line,
  #navbar-mobile.menu-open .burger-line {
    background-color: var(--color-dark-slate);
  }

  /* Dark mode - dark text from the start */
  #navbar-mobile.dark-mode .nav-link {
    color: var(--color-dark-slate);
  }

  #navbar-mobile.dark-mode svg .cls-2 {
    fill: var(--color-dark-slate);
  }

  #navbar-mobile.dark-mode .burger-line {
    background-color: var(--color-dark-slate);
  }

  /* Burger animation when menu is open */
  #navbar-mobile.menu-open #burger-btn .burger-line:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }

  #navbar-mobile.menu-open #burger-btn .burger-line:nth-child(2) {
    opacity: 0;
  }

  #navbar-mobile.menu-open #burger-btn .burger-line:nth-child(3) {
    transform: rotate(-45deg) translate(5px, -5px);
  }
</style>

<script>
  // Handle scroll and menu behavior
  let isMenuOpen = false;

  function handleScroll() {
    const navbar = document.getElementById('navbar-mobile');
    if (navbar && !isMenuOpen) {
      if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
      } else {
        navbar.classList.remove('scrolled');
      }
    }
  }

  function toggleMenu() {
    const navbar = document.getElementById('navbar-mobile');
    if (navbar) {
      isMenuOpen = !isMenuOpen;

      if (isMenuOpen) {
        navbar.classList.add('menu-open');
        navbar.classList.remove('scrolled');
      } else {
        navbar.classList.remove('menu-open');
        handleScroll(); // Recheck scroll position
      }
    }
  }

  // Initialize
  handleScroll();

  // Add scroll listener
  window.addEventListener('scroll', handleScroll);

  // Add burger button click listener
  const burgerBtn = document.getElementById('burger-btn');
  if (burgerBtn) {
    burgerBtn.addEventListener('click', toggleMenu);
  }

  // Close menu when clicking on a link
  const menuLinks = document.querySelectorAll('#menu .nav-link');
  menuLinks.forEach(link => {
    link.addEventListener('click', () => {
      if (isMenuOpen) {
        toggleMenu();
      }
    });
  });

  // Reinitialize on navigation (for Astro view transitions)
  document.addEventListener('astro:page-load', () => {
    isMenuOpen = false;
    handleScroll();
  });
</script>
