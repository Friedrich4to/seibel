---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
	const areas = await getCollection('areas');
	return areas.map((area) => ({
		params: { slug: area.id },
		props: { area },
	}));
}

const { area } = Astro.props;
const { data } = area;
const { Content } = await render(area);

const allAreas = await getCollection('areas');
const otherAreas = allAreas
	.filter((a) => a.id !== area.id)
	.sort((a, b) => a.data.order - b.data.order)
	.slice(0, 3);
---

<Layout
	title={data.title}
	description={data.description}
    navbarDarkMode={true}
>
	<!-- Main Content -->
	<section class="bg-light-gray pt-28 md:pt-36 pb-16 md:pb-24 px-6 md:px-12 lg:px-20">
		<div class="max-w-360 mx-auto grid grid-cols-1 lg:grid-cols-[2fr_3fr] gap-12 lg:gap-20">

			<!-- Left Column (Sticky) -->
			<div class="lg:self-start lg:sticky lg:top-28">
				<h1 class="text-dark-slate text-3xl md:text-4xl lg:text-[2.75rem] font-light tracking-wide uppercase leading-tight">
					{data.title}
				</h1>
				<div class="area-body mt-8">
					<Content />
				</div>
			</div>

			<!-- Right Column (Services) -->
			<div class="flex flex-col gap-12 md:gap-16">
				{data.servicios.map((servicio) => (
					<div class="flex flex-col gap-4">
						<div class="w-16 h-0.75 bg-bronze"></div>
						<h2 class="text-dark-slate text-xl md:text-2xl font-medium leading-snug">
							{servicio.titulo}
						</h2>
						<p class="text-dark-slate text-sm md:text-base font-light leading-relaxed">
							{servicio.descripcion}
						</p>
					</div>
				))}
			</div>
		</div>
	</section>

	<!-- Other Areas Section -->
	<section class="bg-light-gray pb-16 md:pb-24 px-6 md:px-12 lg:px-20">
		<div class="max-w-360 mx-auto">
			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
				{otherAreas.map((otherArea) => (
					<a
						href={`/areas/${otherArea.id}`}
						class="flex flex-col overflow-hidden group"
					>
						<div class="w-full aspect-4/3 overflow-hidden">
							<img
								src={otherArea.data.image}
								alt={otherArea.data.imageAlt}
								class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
							/>
						</div>
						<div class="pt-4 pb-2">
							<h3 class="text-dark-slate text-sm md:text-base font-medium tracking-wider uppercase">
								{otherArea.data.title}
							</h3>
							<div class="w-16 h-0.75 bg-bronze mt-3"></div>
						</div>
					</a>
				))}
			</div>
		</div>
	</section>
</Layout>

<style>
	.area-body :global(p) {
		color: var(--color-dark-slate);
		font-weight: 300;
		font-size: 0.95rem;
		line-height: 1.75;
		margin-bottom: 1rem;
	}

	.area-body :global(ul) {
		list-style-type: disc;
		padding-left: 1.25rem;
		margin-bottom: 1rem;
	}

	.area-body :global(li) {
		color: var(--color-dark-slate);
		font-weight: 300;
		font-size: 0.95rem;
		line-height: 1.75;
	}
</style>
